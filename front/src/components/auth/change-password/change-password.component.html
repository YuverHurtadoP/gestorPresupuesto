<div
  *ngIf="visible"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
>
  <div class="bg-white w-full max-w-md rounded-2xl shadow-lg p-6 relative">
    <button
      (click)="onClose()"
      class="absolute top-3 right-3 text-gray-500 hover:text-gray-700"
    >
      ✖
    </button>

    <h2 class="text-xl font-bold text-purple-700 mb-4">Cambiar clave</h2>

    <form [formGroup]="form" (ngSubmit)="changePassword()" class="space-y-4">
      <!-- Clave actual -->
      <div>
        <label>Clave actual</label>
        <input
          type="password"
          formControlName="currentPassword"
          class="mt-1 w-full border rounded-lg px-3 py-2"
        />
        <p
          *ngIf="form.get('currentPassword')?.touched && form.get('currentPassword')?.invalid"
          class="text-red-500 text-sm"
        >
          La clave actual es obligatoria
        </p>
      </div>

      <!-- Nueva clave -->
      <div>
        <label>Nueva clave</label>
        <input
          type="password"
          formControlName="newPassword"
          class="mt-1 w-full border rounded-lg px-3 py-2"
        />
        <p
          *ngIf="form.get('newPassword')?.touched && form.get('newPassword')?.errors?.['required']"
          class="text-red-500 text-sm"
        >
          La nueva clave es obligatoria
        </p>
        <p
          *ngIf="form.get('newPassword')?.touched && form.get('newPassword')?.errors?.['minlength']"
          class="text-red-500 text-sm"
        >
          La clave debe tener al menos 6 caracteres
        </p>
      </div>

      <!-- Confirmar nueva clave -->
      <div>
        <label>Confirmar nueva clave</label>
        <input
          type="password"
          formControlName="confirmPassword"
          class="mt-1 w-full border rounded-lg px-3 py-2"
        />
        <p
          *ngIf="form.errors?.['mismatch'] && form.get('confirmPassword')?.touched"
          class="text-red-500 text-sm"
        >
          Las contraseñas no coinciden
        </p>
      </div>

      <!-- Botón -->
      <button
        type="submit"
        [disabled]="form.invalid"
        class="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50"
      >
        Guardar cambios
      </button>
    </form>
  </div>
</div>
